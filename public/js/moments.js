const momentsListUtils={pagination:{pageSize:10,pageNum:1},selector:{loadmore:"#momentLoadMore",more:".more",nomore:".nomore",loading:".loading",list:"#momentsBox"},artitalkHelper:null,loadmore:null,list:null,moments:[],init(){this.addLoadmoreListener(),this.artitalkHelper=window.artitalkHelper,this.artitalkHelper.register(this.fetchMoments)},createNode(e){const t=this.getTime(e.createdAt),s=e.atContentMd.replace(/(#[^\s]*)/g,(function(e){return`<span class="tag">${e.replace("#","")}</span>`})),o=document.createElement("div");return o.classList.add("momentsItem"),o.innerHTML=`\n      <p class="time">${t}</p>\n      <p class="content">${s}</p>\n    `,o},getElement:e=>document.querySelector(e),addLoadmoreListener(){const e=this.loadmore||this.getElement(this.selector.loadmore),t=e.querySelector(this.selector.more),s=this;t&&t.addEventListener("click",(()=>{s.fetchMoments()})),this.loadmore||(this.loadmore=e)},fetchMoments(){const e=this.pagination.pageSize,t=(this.pagination.pageNum-1)*this.pagination.pageSize;this.api.get;this.artitalkHelper.getMoments(this.pagination).then((e=>{this.pagination.pageNum++;const t=e.results||[];this.moments=this.moments.concat(t),t.length||toastr.info("没有更多数据了..."),this.updateStatus(t),this.appendMoments(t)}))},updateStatus(){const e=this.loadmore||this.getElement(this.selector.loadmore);data.length>=this.pagination.pageSize?(e.classList.remove(this.pureSelector(this.selector.nomore),this.pureSelector(this.selector.loading)),e.classList.add(this.pureSelector(this.selector.more))):(e.classList.remove(this.pureSelector(this.selector.more),this.pureSelector(this.selector.loading)),e.classList.add(this.pureSelector(this.selector.nomore)))},appendMoments(e){const t=document.querySelector(this.selector.list),s=new DocumentFragment;e.filter((e=>!!e.atContentMd)).forEach((e=>{s.appendChild(this.createNode(e))})),t.appendChild(s),this.list||(this.list=t)}};momentsListUtils.init();